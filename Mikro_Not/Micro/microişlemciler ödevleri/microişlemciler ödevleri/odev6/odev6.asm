list p=16F877A
#include <P16F877A.INC>

ORG 0X00 
GOTO ANA_PROGRAM
ORG 0X04 

REG EQU 0X20
TEMP1 EQU 0X21
TEMP2 EQU 0X22	
TEMP3 EQU 0X23
SAYAC1 EQU 0X24
SAYAC2 EQU 0X25
SAYAC3 EQU 0X26
ELDE EQU 0X27

KESME
BTFSS PIR1,6
RETFIE
BCF PIR1,6

call tempeat
CLRF TEMP1
CLRF TEMP2
CLRF TEMP3
CALL HESAP
CALL CARP3

KESME_BITIR
BCF PIR1,6
RETFIE

HESAP
	BCF STATUS,0
	movlw d'100'
	subwf REG,1
	INCF TEMP1
	BTFSC STATUS,0
	GOTO HESAP
	MOVLW D'100'
	ADDWF REG,1
	DECF TEMP1

HESAP2
	BCF STATUS,0
	MOVLW D'10'
	SUBWF REG,1
	INCF TEMP2
	BTFSC STATUS,0
	GOTO HESAP2
	MOVLW D'10'
	ADDWF REG,1
	DECF TEMP2
	
	MOVF REG,0
	MOVWF TEMP3
	RETURN

CARP3
	BCF STATUS,0
	CLRF ELDE
	RLF TEMP3,1
	MOVLW D'10'
	SUBWF TEMP3,0
	BTFSS STATUS,0
	GOTO CARP2
	MOVLW D'10'
	SUBWF TEMP3,1
	INCF ELDE

CARP2
	BCF STATUS,0
	RLF TEMP2,1
	BTFSC ELDE,0
	INCF TEMP2
	CLRF ELDE
	BCF STATUS,0
	MOVLW D'10'
	SUBWF TEMP2,0
	BTFSS STATUS,0
	GOTO CARP1
	MOVLW D'10'
	SUBWF TEMP2,1
	INCF ELDE

CARP1
	BCF STATUS,0
	RLF TEMP1,1
	BTFSC ELDE,0
	INCF TEMP1
	RETURN

tempeat
	btfss ADRESH,0
	goto kisim2
	goto kisim1

kisim1
	btfss ADRESH,1
	goto ikinci
	goto dorduncu

kisim2
	btfss ADRESH,1
	goto birinci
	goto ucuncu

birinci
	
	BSF STATUS,5
	movf ADRESL,W
	BCF STATUS,5
	movwf REG
	call dordebol
	return
	
ikinci	
	BSF STATUS,5
	movf ADRESL,0
	BCF STATUS,5
	movwf REG
	call dordebol
	movlw d'62'
	addwf REG,F
	return

ucuncu
	BSF STATUS,5
	movf ADRESL,0
	BCF STATUS,5
	movwf REG
	call dordebol
	movlw d'125'
	addwf REG,F
	return
	
dorduncu
	BSF STATUS,5
	movf ADRESL,0
	BCF STATUS,5
	movwf REG
	call dordebol
	movlw d'187'
	addwf REG,F
	return
	
dordebol
	rrf REG,f
	rrf REG,f
	movlw b'00111111'
	andwf REG,1
	return


TABLE 
ADDWF PCL,F
RETLW B'00111111'	;0
RETLW B'00000110'	;1
RETLW B'01011011'	;2
RETLW B'01001111'	;3
RETLW B'01100110'	;4
RETLW B'01101101'	;5
RETLW B'01111101'	;6
RETLW B'00000111'	;7
RETLW B'01111111'	;8
RETLW B'01101111'	;9

GECIKME
MOVLW D'50' 
MOVWF SAYAC1
DONGU1
MOVLW D'50'
MOVWF SAYAC2
DONGU2
DECFSZ SAYAC2,F
GOTO DONGU2
DECFSZ SAYAC1,F
GOTO DONGU1
RETURN

ALT

	BSF ADCON0,2

CHECK1
	BTFSC ADCON0,2
	GOTO CHECK1

RETURN

ANA_PROGRAM

	CLRF TEMP1
	CLRF TEMP2
	CLRF TEMP3

MOVLW D'255'
MOVWF REG
MOVLW D'255'
MOVWF SAYAC3
    bsf STATUS,5
    MOVLW H'8E'
	MOVWF ADCON1
	bcf STATUS,5
	MOVLW H'81'
	MOVWF ADCON0

	MOVLW B'11000000'		;GIE, PEIE VE RBIE AKTÝF
	MOVWF INTCON
	MOVLW H'0E'				;DÝSPLAYLERÝ AKTÝF ET
	MOVWF PORTA
	CLRF PORTD				;ÝLK DEÐER 0000 YAPILDI

	BSF STATUS,5
	MOVLW H'01'
	MOVWF TRISA				;DÝSPLAY ÝÇÝN PORTA YI ÇIKIÞ YAP
	CLRF TRISD				;DÝSPLAY ÝÇÝN ÇIKIÞ YAP
CLRF TRISB
	BSF PIE1,6
	BCF STATUS,5
	BCF PIR1,6

DONGU

CALL ALT

CALL GECIKME

MOVLW B'00000010'		
MOVWF  PORTA
MOVF TEMP3,0
CALL TABLE

MOVWF PORTD

CALL GECIKME

MOVLW B'00000100'	
MOVWF PORTA
MOVF TEMP2,0
CALL TABLE

MOVWF PORTD

CALL GECIKME

MOVLW B'00001000'		
MOVWF PORTA
MOVF TEMP1,0
CALL TABLE

MOVWF PORTD


GOTO DONGU

END


